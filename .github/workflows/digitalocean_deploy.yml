name: build
on:
  push:
    branches:
      - deploy/dev
      - deploy/production
      - devops-chris

        # This allows a subsequently queued workflow run to interrupt previous runs
concurrency:
  group: '${{ github.workflow }} @ ${{ github.event.pull_request.head.label || github.head_ref || github.ref }}'
  cancel-in-progress: true

jobs:
  build-and-deploy:
    runs-on: ${{ fromJSON('["ubuntu-latest", "self-hosted"]')[github.repository == 'github/docs-internal'] }}
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: testing
        run: |
          echo 'LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUFNd0FBQUF0emMyZ3RaVwpReU5UVXhPUUFBQUNCYzQybnZRb3BqZXVhUTJ0Y3NUdnlWcGxLL0pkRnZSQW5aM0ZNZzFSWE55d0FBQUpqNkQzSncrZzl5CmNBQUFBQXR6YzJndFpXUXlOVFV4T1FBQUFDQmM0Mm52UW9wamV1YVEydGNzVHZ5VnBsSy9KZEZ2UkFuWjNGTWcxUlhOeXcKQUFBRURTb2VCcHhXVUF6ZW5HTEhaRmRhUzdhQi95dHJ4YkhxQ0xKZFFFb0xUY21semphZTlDaW1ONjVwRGExeXhPL0pXbQpVcjhsMFc5RUNkbmNVeURWRmMzTEFBQUFEMk5vY21selFHSnNkV1ZpWlhKeWVRRUNBd1FGQmc9PQotLS0tLUVORCBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0K' | base64 -d > ssh.key
          ssh -o StrictHostKeyChecking=no -i ssh.key devops@134.209.65.8 "/home/devops/infra/scripts/deploy.sh" 
